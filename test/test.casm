start:
    test1
    test2
    test3
    test4
    test5
    test6
    ret

outputHexDigit:
    dup' 9' >' $.letter if
    '0' +' int' ret

    .letter:
        'A' 10' -' +' int' ret

outputHexByte:
    dup' 4' >>' outputHexDigit
    0b1111' &' outputHexDigit
    ret

outputHexLong:
    outputHexByte
    outputHexByte
    outputHexByte
    outputHexByte
    '\n' int'
    ret

test1: ( Simple count-controlled loop )
    'A' int' ( Print A )

    10 ( Loop 10 times )

    .loop:
        'B' int' ( Print B )
        -- ( Decrement loop counter )
        dup 0 > $.loop if ( Loop if not zero )

    '\n' int' ( Print newline )

    ret

test2: ( Outputting hex )
    0xA1B2C3D4 outputHexLong
    '\n' int'
    ret

test3: ( Fibonacci sequence )
    ${.a: [0] .b: [1]}

    10

    .loop:
        {$.a get} {$.b get} +
        dup outputHexLong
        $.b get $.a set
        $.b set

        --
        dup 0 > $.loop if

    ret

test4: ( Groups )
    {'A' int'}
    {0' ?{'B' int'}}
    {1' ?{'C' int'}}
    :{0x44' int' ret}
    ${0x45' int'}
    call

    '\n' int'

    ret

print:
    .loop:
        dup get'
        dup' 0' =' $.end if
        int'
        ++
        $.loop jump

    .end:
        drop
        ret

testString: ["Test string!\n" 0]

test5: ( Strings )
    "Hello, world!\n" print
    "This is a test!\n" print
    $testString print

    ret

Person:
    .age: [0]
    .test: [0]
    .team: ['x']

test6: ( Objects )
    Person~ outputHexLong
    Person.age~ outputHexLong
    Person.test~ outputHexLong
    Person.team~ outputHexLong

    ret